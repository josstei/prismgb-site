---
interface Props {
  class?: string;
}

const { class: className = '' } = Astro.props;
---

<div class:list={['artwork__connection', className]} id="connectionCable">
  <!-- Clean L-shaped cable using single SVG path - connector centered at x=90 to match gameboy center -->
  <svg class="cable-svg" viewBox="0 0 210 70" fill="none" xmlns="http://www.w3.org/2000/svg">
    <!-- Top connector (centered at 105px to match gameboy center) -->
    <rect x="94" y="0" width="22" height="14" rx="2" fill="url(#connectorGradient)" />

    <!-- Single L-shaped wire path -->
    <path d="M105 20 L105 48 Q105 58 115 58 L214 58" stroke="#2d3748" stroke-width="10" fill="none" stroke-linecap="round" stroke-linejoin="round" />

    <!-- Right connector (extends past edge to reach app border) -->
    <rect x="200" y="48" width="18" height="22" rx="2" fill="url(#connectorGradient)" />

    <defs>
      <linearGradient id="connectorGradient" x1="0%" y1="0%" x2="0%" y2="100%">
        <stop offset="0%" stop-color="#6b7280" />
        <stop offset="100%" stop-color="#4b5563" />
      </linearGradient>
    </defs>
  </svg>

  <!-- Pulse effect overlay -->
  <svg class="cable-pulse" viewBox="0 0 210 70" fill="none" xmlns="http://www.w3.org/2000/svg" id="connectionPulse">
    <path class="pulse-path" d="M105 20 L105 48 Q105 58 115 58 L200 58" stroke="var(--accent-bright)" stroke-width="3" fill="none" stroke-linecap="round" stroke-linejoin="round" />
  </svg>
</div>

<style>
  .artwork__connection {
    position: relative;
    width: 180px;
    height: 70px;
    flex-shrink: 0;
    overflow: visible;
  }

  .artwork__connection .cable-svg,
  .artwork__connection .cable-pulse {
    overflow: visible;
  }

  .cable-svg {
    width: 100%;
    height: 100%;
  }

  .cable-pulse {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
  }

  .pulse-path {
    stroke-dasharray: 150;
    stroke-dashoffset: 150;
    animation: cable-pulse 2.5s ease-in-out infinite;
  }

  .cable-pulse.disconnected .pulse-path {
    animation: none;
    opacity: 0;
  }

  @keyframes cable-pulse {
    0%, 100% {
      stroke-dashoffset: 150;
      opacity: 0;
    }
    10% {
      opacity: 1;
    }
    50% {
      stroke-dashoffset: 0;
      opacity: 1;
    }
    60% {
      opacity: 0;
    }
  }

  /* Fallback to horizontal cable on smaller screens */
  @media (max-width: 1100px) {
    .artwork__connection {
      width: 80px;
      height: 30px;
    }

    .cable-svg {
      display: none;
    }

    .cable-pulse {
      display: none;
    }

    /* Simple horizontal cable fallback */
    .artwork__connection::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 0;
      right: 0;
      height: 8px;
      background: linear-gradient(180deg, #374151 0%, #1f2937 100%);
      transform: translateY(-50%);
      border-radius: 2px;
    }

    .artwork__connection::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 60%;
      height: 3px;
      background: var(--accent-bright);
      transform: translate(-50%, -50%) scaleX(0);
      animation: cable-pulse-simple 2s ease-in-out infinite;
    }
  }

  @keyframes cable-pulse-simple {
    0%, 100% {
      transform: translate(-50%, -50%) scaleX(0);
      opacity: 0;
    }
    50% {
      transform: translate(-50%, -50%) scaleX(1);
      opacity: 1;
    }
  }
</style>
